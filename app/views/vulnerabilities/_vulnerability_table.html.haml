.vulnerabilities-filter
  = render partial: 'version_filter'
.vulnerabilities-datatable
  - if @vulnerabilities.present?
    %table.table.table-striped
      %thead
        %tr#dingus-row
          %td{ colspan: 5 } &nbsp;
        %tr
          %th.col-md-1= t('vulnerabilities.index.cve_id')
          %th.col-md-1= t('vulnerabilities.index.severity')
          %th.col-md-1= t('vulnerabilities.index.date_published')
          %th.col-md-3= t('vulnerabilities.index.description')
          %th.col-md-3= t('vulnerabilities.index.versions_affected')
      %tbody
        - @vulnerabilities.each do |vulnerability|
          %tr.nvd_link{ 'data-nvd-link' => (ENV['NVD_LINK'] + vulnerability.cve_id).to_s }
            %td= vulnerability.cve_id
            %td= vulnerability.severity.titleize
            %td= vulnerability.published_on.to_s(:mdy)
            %td.vul_description
              - if vulnerability.description
                %span#read_less
                  = vulnerability.description[0..Vulnerability::DESC_LENGTH]
                  = link_to t('vulnerabilities.index.more'), 'javascript:void(0)' if vulnerability.description.length > Vulnerability::DESC_LENGTH
                %span#read_more{ style: 'display: none;' }
                  = vulnerability.description
                  = link_to t('vulnerabilities.index.less'), 'javascript:void(0)'
            %td
              .versions_affected= vulnerability.recent_releases
    .text-center
      = will_paginate @vulnerabilities, params: { controller: 'vulnerabilities', action: 'index' }
  - else
    .no_vulnerability= t('vulnerabilities.index.no_vulnerability')
