- if @vulnerabilities.present?
  %table.table.table-striped
    %thead
      %tr
        %th.col-md-1
          = t('vulnerabilities.index.cve_id')
          = render_sort_icon('cve_id')
        %th.col-md-1{ style: 'min-width: 95px;' }
          = t('vulnerabilities.index.severity')
          = render_sort_icon('severity')
        %th.col-md-2
          = t('vulnerabilities.index.date_published')
          = render_sort_icon('published_on')
        %th.col-md-5= t('vulnerabilities.index.description')
        %th.col-md-3= t('vulnerabilities.index.versions_affected')
    %tbody
      - @vulnerabilities.each do |vulnerability|
        %tr.nvd_link{ 'data-nvd-link' => (ENV['NVD_LINK'] + vulnerability.cve_id).to_s }
          %td= vulnerability.cve_id
          %td= vulnerability.severity.titleize
          %td= vulnerability.published_on.to_s(:mdy)
          %td.vul_description
            - if vulnerability.description
              %span#read_less
                - vuln_length = vulnerability.description.length
                - vuln_length_count = Vulnerability::DESC_LENGTH
                = vulnerability.description[0..Vulnerability::DESC_LENGTH]
                = link_to t('vulnerabilities.index.more'), 'javascript:void(0)' if vuln_length > vuln_length_count
              %span#read_more{ style: 'display: none;' }
                = vulnerability.description
                = link_to t('vulnerabilities.index.less'), 'javascript:void(0)'
          %td
            .versions_affected= vulnerability[:recent_releases]
  .text-center
    = will_paginate @vulnerabilities, params: { controller: 'vulnerabilities', action: 'filter' }
- else
  .no_vulnerability= t('vulnerabilities.index.no_vulnerability')

.overlay-loader
  %img.loader{ src: image_path('ui/loadingAnimation.gif') }
