require 'test_helper'

class ProjectVulnerabilityReportsHelperTest < ActionView::TestCase
  include ProjectVulnerabilityReportsHelper

  it 'must return the width of the scale when its security score' do
    pvr = stub(security_score: 23.12)
    pointer(pvr, false).must_equal '19%'
  end

  it 'must return the width of the scale when its security score with extra css' do
    pvr = stub(security_score: 134.85)
    pointer(pvr, false).must_equal '113%;width: 32px;'
  end

  it 'must return the width of the scale when its vulnerability score' do
    create(:project_vulnerability_report)
    pvr = stub(vulnerability_score: 400.00)
    pointer(pvr, true).must_equal '62%'
  end

  it 'must return the formatted security score' do
    pvr = stub(security_score: 67.20)
    pss_content(pvr).must_equal '67.2%'
  end

  it 'must return the maximum score' do
    create(:project_vulnerability_report, vulnerability_score: 3456)
    max_score.must_equal 3456.0
  end

  it 'must get the tooltip content' do
    pvr = create(:project_vulnerability_report)
    pvs_content(pvr).must_equal 'Score: 546.0 <br/> Rank: 1st of 1'
  end
end
